<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Intune.Commander.Desktop.ViewModels"
             xmlns:lvc="using:LiveChartsCore.SkiaSharpView.Avalonia"
             xmlns:suki="https://github.com/kikipoulet/SukiUI"
             xmlns:mi="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
             xmlns:icons="clr-namespace:Material.Icons;assembly=Material.Icons"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="900"
             x:Class="Intune.Commander.Desktop.Views.OverviewView"
             x:DataType="vm:OverviewViewModel">

    <Panel>
    <!-- Loading overlay -->
    <suki:BusyArea BusyText="Loading dashboard data..."
                   IsBusy="{Binding IsLoading}"
                   IsVisible="{Binding IsLoading}"
                   ZIndex="10" />

    <!-- Dashboard content -->
    <ScrollViewer HorizontalScrollBarVisibility="Disabled" IsVisible="{Binding !IsLoading}">
        <StackPanel Margin="16" Spacing="16">

            <!-- ═══════════════════════════════════════════ -->
            <!-- Welcome Banner                             -->
            <!-- ═══════════════════════════════════════════ -->
            <StackPanel Spacing="4" Margin="0,4,0,4">
                <TextBlock FontSize="24" FontWeight="Bold">
                    <Run Text="Welcome, " />
                    <Run Text="{Binding TenantName}" Foreground="{DynamicResource SystemControlForegroundAccentBrush}" />
                </TextBlock>
                <StackPanel Orientation="Horizontal" Spacing="16">
                    <TextBlock FontSize="13" Foreground="{DynamicResource AppTextSecondaryBrush}">
                        <Run Text="Tenant ID:" />
                        <Run Text="{Binding TenantId}" />
                    </TextBlock>
                    <TextBlock FontSize="13" Foreground="{DynamicResource AppTextSecondaryBrush}">
                        <Run Text="Cloud:" />
                        <Run Text="{Binding CloudEnvironment}" />
                    </TextBlock>
                </StackPanel>
            </StackPanel>

            <!-- ═══════════════════════════════════════════ -->
            <!-- Quick Stats Row (compact, like mockup)     -->
            <!-- ═══════════════════════════════════════════ -->
            <Grid ColumnDefinitions="*,*,*,*" Margin="0,0,0,0">
                <Button Grid.Column="0" Command="{Binding NavigateToDeviceConfigsCommand}"
                        Padding="0" Margin="0,0,6,0"
                        Background="Transparent" BorderThickness="0"
                        Cursor="Hand" HorizontalAlignment="Stretch"
                        ToolTip.Tip="View Device Configurations">
                    <suki:GlassCard Padding="14,12">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TotalDeviceConfigs}" FontSize="26" FontWeight="Bold"
                                       Foreground="#2196F3" />
                            <TextBlock FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}">
                                <Run Text="● " Foreground="#2196F3" /><Run Text="DEVICE CONFIGS" />
                            </TextBlock>
                        </StackPanel>
                    </suki:GlassCard>
                </Button>
                <Button Grid.Column="1" Command="{Binding NavigateToCompliancePoliciesCommand}"
                        Padding="0" Margin="3,0,3,0"
                        Background="Transparent" BorderThickness="0"
                        Cursor="Hand" HorizontalAlignment="Stretch"
                        ToolTip.Tip="View Compliance Policies">
                    <suki:GlassCard Padding="14,12">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TotalCompliancePolicies}" FontSize="26" FontWeight="Bold"
                                       Foreground="#4CAF50" />
                            <TextBlock FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}">
                                <Run Text="● " Foreground="#4CAF50" /><Run Text="COMPLIANCE" />
                            </TextBlock>
                        </StackPanel>
                    </suki:GlassCard>
                </Button>
                <Button Grid.Column="2" Command="{Binding NavigateToApplicationsCommand}"
                        Padding="0" Margin="3,0,3,0"
                        Background="Transparent" BorderThickness="0"
                        Cursor="Hand" HorizontalAlignment="Stretch"
                        ToolTip.Tip="View Applications">
                    <suki:GlassCard Padding="14,12">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TotalApplications}" FontSize="26" FontWeight="Bold"
                                       Foreground="#FF9800" />
                            <TextBlock FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}">
                                <Run Text="● " Foreground="#FF9800" /><Run Text="APPLICATIONS" />
                            </TextBlock>
                        </StackPanel>
                    </suki:GlassCard>
                </Button>
                <Button Grid.Column="3" Command="{Binding NavigateToSettingsCatalogCommand}"
                        Padding="0" Margin="6,0,0,0"
                        Background="Transparent" BorderThickness="0"
                        Cursor="Hand" HorizontalAlignment="Stretch"
                        ToolTip.Tip="View Settings Catalog Policies">
                    <suki:GlassCard Padding="14,12">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TotalSettingsCatalog}" FontSize="26" FontWeight="Bold"
                                       Foreground="#9C27B0" />
                            <TextBlock FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}">
                                <Run Text="● " Foreground="#9C27B0" /><Run Text="SETTINGS CATALOG" />
                            </TextBlock>
                        </StackPanel>
                    </suki:GlassCard>
                </Button>
            </Grid>

            <!-- ═══════════════════════════════════════════ -->
            <!-- Quick Stats Row 2                          -->
            <!-- ═══════════════════════════════════════════ -->
            <Grid ColumnDefinitions="*,*,*,*" Margin="0,0,0,0">
                <Button Grid.Column="0" Command="{Binding NavigateToEndpointSecurityCommand}"
                        Padding="0" Margin="0,0,6,0"
                        Background="Transparent" BorderThickness="0"
                        Cursor="Hand" HorizontalAlignment="Stretch"
                        ToolTip.Tip="View Endpoint Security Policies">
                    <suki:GlassCard Padding="14,12">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TotalEndpointSecurity}" FontSize="26" FontWeight="Bold"
                                       Foreground="#00BCD4" />
                            <TextBlock FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}">
                                <Run Text="● " Foreground="#00BCD4" /><Run Text="ENDPOINT SECURITY" />
                            </TextBlock>
                        </StackPanel>
                    </suki:GlassCard>
                </Button>
                <Button Grid.Column="1" Command="{Binding NavigateToConditionalAccessCommand}"
                        Padding="0" Margin="3,0,3,0"
                        Background="Transparent" BorderThickness="0"
                        Cursor="Hand" HorizontalAlignment="Stretch"
                        ToolTip.Tip="View Conditional Access Policies">
                    <suki:GlassCard Padding="14,12">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TotalConditionalAccess}" FontSize="26" FontWeight="Bold"
                                       Foreground="#E91E63" />
                            <TextBlock FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}">
                                <Run Text="● " Foreground="#E91E63" /><Run Text="CONDITIONAL ACCESS" />
                            </TextBlock>
                        </StackPanel>
                    </suki:GlassCard>
                </Button>
                <Button Grid.Column="2" Command="{Binding NavigateToScriptsCommand}"
                        Padding="0" Margin="3,0,3,0"
                        Background="Transparent" BorderThickness="0"
                        Cursor="Hand" HorizontalAlignment="Stretch"
                        ToolTip.Tip="View Device Scripts">
                    <suki:GlassCard Padding="14,12">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TotalScripts}" FontSize="26" FontWeight="Bold"
                                       Foreground="#009688" />
                            <TextBlock FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}">
                                <Run Text="● " Foreground="#009688" /><Run Text="SCRIPTS" />
                            </TextBlock>
                        </StackPanel>
                    </suki:GlassCard>
                </Button>
                <Button Grid.Column="3" Command="{Binding NavigateToUnassignedAppsCommand}"
                        Padding="0" Margin="6,0,0,0"
                        Background="Transparent" BorderThickness="0"
                        Cursor="Hand" HorizontalAlignment="Stretch"
                        ToolTip.Tip="View Unassigned Applications">
                    <suki:GlassCard Padding="14,12">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding UnassignedAppCount}" FontSize="26" FontWeight="Bold"
                                       Foreground="#F44336" />
                            <TextBlock FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}">
                                <Run Text="● " Foreground="#F44336" /><Run Text="UNASSIGNED APPS" />
                            </TextBlock>
                        </StackPanel>
                    </suki:GlassCard>
                </Button>
            </Grid>

            <!-- ═══════════════════════════════════════════ -->
            <!-- Charts Row: Pie charts side by side        -->
            <!-- ═══════════════════════════════════════════ -->
            <Grid ColumnDefinitions="*,16,*">
                <!-- Apps by Platform -->
                <suki:GlassCard Padding="12">
                    <DockPanel>
                        <TextBlock DockPanel.Dock="Top" Text="Applications by Platform"
                                   FontSize="14" FontWeight="SemiBold" Margin="0,0,0,4" />
                        <lvc:PieChart Series="{Binding AppsByPlatformSeries}"
                                      LegendPosition="Bottom"
                                      Height="220" />
                    </DockPanel>
                </suki:GlassCard>

                <!-- Configs by Platform -->
                <suki:GlassCard Grid.Column="2" Padding="12">
                    <DockPanel>
                        <TextBlock DockPanel.Dock="Top" Text="Configurations by Platform"
                                   FontSize="14" FontWeight="SemiBold" Margin="0,0,0,4" />
                        <lvc:PieChart Series="{Binding ConfigsByPlatformSeries}"
                                      LegendPosition="Bottom"
                                      Height="220" />
                    </DockPanel>
                </suki:GlassCard>
            </Grid>

            <!-- ═══════════════════════════════════════════ -->
            <!-- Recently Modified                          -->
            <!-- ═══════════════════════════════════════════ -->
            <suki:GlassCard Padding="12">
                <DockPanel>
                    <TextBlock DockPanel.Dock="Top" Text="Recently Modified"
                               FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8" />
                    <ItemsControl ItemsSource="{Binding RecentlyModified}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="vm:RecentItem">
                                <Border Padding="8,6" Margin="0,0,0,2" CornerRadius="4">
                                    <DockPanel>
                                        <TextBlock DockPanel.Dock="Right" Text="{Binding ModifiedText}"
                                                   FontSize="11" Foreground="{DynamicResource AppTextSecondaryBrush}"
                                                   VerticalAlignment="Center" />
                                        <StackPanel Spacing="1">
                                            <TextBlock Text="{Binding Name}" FontSize="13"
                                                       TextTrimming="CharacterEllipsis"
                                                       FontWeight="Medium" />
                                            <TextBlock Text="{Binding Category}" FontSize="11"
                                                       Foreground="{DynamicResource SystemControlForegroundAccentBrush}" />
                                        </StackPanel>
                                    </DockPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </DockPanel>
            </suki:GlassCard>

        </StackPanel>
    </ScrollViewer>
    </Panel>
</UserControl>
